<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Lab #2 - 打字機消消樂</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<style>
  #container {
    border: 1px solid #000;
    padding: 10px;
    margin: 20px auto;
    width: 80%;
    height: 200px;
    overflow-y: auto;
    font-size: 24px;
  }
</style>
</head>
<body>
<h1>Lab #2 - 打字機消消樂</h1>
<p>說明：只能輸入小寫字母</p>
<div id="container" tabindex="0" class="blockquote text-nowrap"></div>
<script>
var container = document.getElementById('container');

function randomNumber(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

window.addEventListener('keypress', function(e) {
    console.log(e.key);
    if (e.key == 'Escape') {
        container.textContent = '';
    } else if (e.key == 'Backspace') {
        container.textContent = container.textContent.slice(0, -1);
    } else if (e.key.length == 1 && e.key.match(/[a-z]/)) {
        if (e.key == container.textContent[0]) {
            console.log('Matched: ' + e.key);
            container.textContent = container.textContent.slice(1);
            addch(randomNumber(1, 3));
            return;
        }
        container.textContent += e.key;
    }
})

function addch(n = 1) {
    for (var i = 0; i < n; i++) {
        container.textContent += String.fromCharCode(97 + Math.floor(Math.random() * 26));
    }
}

function main() {
    addch(randomNumber(0, 2));
}

window.onload = main;
</script>
</body>
</html>
